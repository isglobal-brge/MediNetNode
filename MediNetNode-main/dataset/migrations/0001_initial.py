# Generated by Django 5.2.3 on 2025-08-17 10:58

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Dataset',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=200, unique=True)),
                ('description', models.TextField()),
                ('file_path', models.CharField(max_length=500)),
                ('uploaded_by_id', models.IntegerField(help_text='ID of user who uploaded the dataset')),
                ('medical_domain', models.CharField(choices=[('cardiology', 'Cardiology'), ('neurology', 'Neurology'), ('oncology', 'Oncology'), ('radiology', 'Radiology'), ('pathology', 'Pathology'), ('dermatology', 'Dermatology'), ('ophthalmology', 'Ophthalmology'), ('general', 'General Medicine'), ('other', 'Other')], default='general', max_length=50)),
                ('patient_count', models.PositiveIntegerField(blank=True, null=True)),
                ('data_type', models.CharField(choices=[('tabular', 'Tabular Data'), ('image', 'Image Data'), ('text', 'Text Data'), ('time_series', 'Time Series'), ('mixed', 'Mixed Data')], default='tabular', max_length=50)),
                ('anonymized', models.BooleanField(default=True)),
                ('file_size', models.BigIntegerField(help_text='File size in bytes')),
                ('file_format', models.CharField(choices=[('csv', 'CSV'), ('json', 'JSON'), ('parquet', 'Parquet'), ('h5', 'HDF5'), ('npy', 'NumPy'), ('other', 'Other')], default='csv', max_length=50)),
                ('columns_count', models.PositiveIntegerField(blank=True, null=True)),
                ('rows_count', models.PositiveIntegerField(blank=True, null=True)),
                ('uploaded_at', models.DateTimeField(auto_now_add=True)),
                ('last_accessed', models.DateTimeField(blank=True, null=True)),
                ('access_count', models.PositiveIntegerField(default=0)),
                ('checksum_md5', models.CharField(editable=False, max_length=32)),
                ('is_active', models.BooleanField(default=True)),
                ('target_column', models.CharField(blank=True, help_text='Column name that will be used as target for federated learning', max_length=100, null=True)),
            ],
            options={
                'ordering': ['-uploaded_at'],
            },
        ),
        migrations.CreateModel(
            name='DatasetMetadata',
            fields=[
                ('dataset', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, primary_key=True, related_name='metadata', serialize=False, to='dataset.dataset')),
                ('statistical_summary', models.JSONField(default=dict, help_text='Statistical summary (mean, std, min, max, etc.)')),
                ('missing_values', models.JSONField(default=dict, help_text='Missing values count per column')),
                ('data_distribution', models.JSONField(default=dict, help_text='Data distribution information per column')),
                ('quality_score', models.FloatField(blank=True, help_text='Overall dataset quality score (0.0-1.0)', null=True)),
                ('completeness_percentage', models.FloatField(blank=True, help_text='Data completeness percentage', null=True)),
                ('generated_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['-updated_at'],
            },
        ),
        migrations.CreateModel(
            name='DatasetAccess',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('user_id', models.IntegerField(help_text='ID of user in main database')),
                ('assigned_by_id', models.IntegerField(help_text='ID of user who assigned access in main database')),
                ('assigned_at', models.DateTimeField(auto_now_add=True)),
                ('can_train', models.BooleanField(default=True)),
                ('can_view_metadata', models.BooleanField(default=True)),
                ('dataset', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='access_permissions', to='dataset.dataset')),
            ],
            options={
                'ordering': ['-assigned_at'],
                'unique_together': {('dataset', 'user_id')},
            },
        ),
    ]
